\chapter{Topology of the model and vicinity information}
\label{chapter:vicinity}

In the basic model of minority games all agents act independently without the ability to communicate with each other.
Only means of passing information between them is by using the history of the model that encapsulates all the decisions made by agents in a string of bits.
This simple model allows us to study certain characteristics of competitive systems with limited resources, however it is not a realistic assumption to think of agents as isolated elements that don't communicate with their neighbours.

Once the information of the neighbouring agents is added to the model, two important factors start to influence the dynamics of the system, (i) the dimension of the vicinity, ie. the quantity of neighbouring agents and (ii) the topology of the network generated.

In this chapter we introduce various structures used to model vicinity and how they influence the information flow in the system.
Before diving into vicinity structures, the modifications of the basic model of minority games to include local information is defined in \ref{sec:model modifications}.
First sections, \ref{sec:fixed communities} and \ref{sec:sliding communities}, refer to rather simple structures that are computationally easy to implement and maintain, however they do not express much similarity with real world applications. 
Another similar structure is explained in \ref{sec:von neumann} based on von Neumann distance. 
In the later sections, \ref{sec:scale free}, \ref{sec:small world} and \ref{sec:custom vicinity}, more complex structures are introduced based on graph theory that simulate real world examples more closely. 

\section{Model modifications to include local information}
\label{sec:model modifications}

Once decided to make available new information to agents, we need to decide what that information should be and how will it be used by agents.

Information that we decided to include is the results of reduced minority games consisting of agents in the community.
In addition to global minority game, additional $C$ minority games are added, where $C$ is the number of communities that we want to include.
Each minority game follows the same definitions from Chapter \ref{chapter:minority} and the information generated is available to the agents that define the community. 
Another convention used here is that each minority game contains the same quantity of information available as the global minority game, meaning that if the length of the string of bits representing history is equal to $M$, then also the local history remembered should be $M$ bits long.

To incorporate this change in our basic model the simplest way is to create new kind of agents, called \textit{community agents}, that have the same behaviour, but their brain size is doubled.
By doubling the brain size, we do not have to change the implementation of strategies, only the history that is passed as argument to each strategy. 
For example, a strategy of a new community agent with brain size $2$ is generated is the same fashion as a strategy of a basic agent with brain size $4$ is generated.
A strategy for community agent with brain size $2$ is visible in figure \ref{table:communityStrategy} where first 2 bits, denominated local, are generated by the community minority game of the agent, and second 2 bits, denominated global, are generated by minority game consisting of all the agents.

\begin{table}
\centering
\begin{tabular}{|l|l||l|l| |c|}
\hline
\multicolumn{2}{|c||}{local}&
\multicolumn{2}{|c||}{global}&
\multicolumn{1}{|c|}{prediction} \\
\hline
\hline
0 & 0 & 0 & 1 & 1   \\ \hline
0 & 0 & 1 & 1 & 0   \\ \hline
0 & 1 & 0 & 0 & 0   \\ \hline
0 & 1 & 1 & 1 & 1   \\ \hline
1 & 0 & 0 & 0 & 0   \\ \hline
1 & 0 & 1 & 1 & 0   \\ \hline
1 & 1 & 0 & 0 & 1   \\ \hline
1 & 1 & 1 & 0 & 0   \\ \hline
\end{tabular}
\caption{Example strategy of a community agent with brain size 2}
\label{table:communityStrategy}
\end{table}

One particular case that should be noted is that by dividing the agents in communities, depending on the procedure used, a minority game where the number of agents is pair can occur.
In this case additional guard should be put in the simulation to generate a random winning side when the attendance is equal to $\frac{N}{2}$.
Of course certain procedures are implemented to reduce the number of community minority games with pairwise number of agents to minimum in order to reduce the influence on the whole model. 
Using simple structures this condition does not usually present itself, however when more complex structures are implemented it occurs with higher frequency.
Ad hoc procedures have been implemented in this thesis to reduce the number of pairwise minority games when using scale free and small world structures.

\section{Fixed one-dimensional communities}
\label{sec:fixed communities}

The simplest approach to include local information inside the model is to divide agents in certain number of communities.
By using a one-dimensional list to represent agents we can divide the array in equal parts to model communities.
Let's assume $N$ the number of agents, and $C$ number of communities, the communities are defined as
\begin{displaymath}
C_i = \bigcup agent_j \qquad|\qquad j\in [i, i+\frac{N}{C})
\end{displaymath}
An example division can be seen in figure \ref{fig:fixed vicinity} where a set of $15$ agents is divided in $5$ communities.
When the rest of $\frac{N}{C}$ is different from zero, last $N$ mod $C$ agents are assigned to their own community.

\input{slidingwindow00}

This structure creates isolated communities and only way for information to flow between communities is through the global state.
Same local information is available for each agent of the community and it is expected that this information will be used efficiently as they are all involved in the same minority game at a local level. 
However this sort of connectivity between agents does not represent real world examples as in most scenarios communities are not isolated from each other.

\section{Sliding window communities}
\label{sec:sliding communities}

To overcome the difficulty of having isolated communities we take different approach and create a community for each agent.
This is more representative of real world cases and also of the way minority games are defined.

Sliding window technique is used to create communities by creating a local neighbourhood for each agent.
Another possibility opens up here in deciding how many dimension we want to use to represent the set of agents.
We have used one-dimensional arrays and two-dimensional matrix to group agents into communities, and have not delved in higher dimensions as it does not bring any qualitative change, only modifies the graphical representation of agents.

\subsection{Sliding window on one-dimensional array}

Let's assume $N$ is the number of agents and $V$ is an odd integer representing the number of neighbours in each community.
For each agent $a_i$ a community $C_i$ is created from a sliding window of length $V$ centred on agent $a_i$.
an example of this simple procedure can be seen in figure \ref{fig:sliding window one-dimension}

\input{slidingwindow01}

\subsection{Sliding window on a matrix}

Different approach is to represent agents in two-dimensional array and construct neighbourhoods on the matrix generated.
This opens possibilities to use different rules for generating the vicinity, such as using the Manhattan distance to generate von Neumann vicinity as described in \ref{sec:von neumann}.
Another simple metric that can be used to generate neighbourhood is Chebyshev distance.
The Chebyshev distance, named after Pafnuty Chebyshev and also called chessboard distance, is defined as a greatest difference of distance along any coordinate dimension between two vectors.

\begin{displaymath}
D_{Chebyshev}(p,q) := max_i (|p_i-q_i|) 
\end{displaymath}

For each agent a community is generated that includes all agents with $D_{Chebyshev}$ less or equal than $R$, where $R$ is the radius of the neighbourhood.

\input{tikz/chebyshev}

\section{Von Neumann Vicinity}
\label{sec:von neumann}

Along with the chessboard metric, Manhattan distance is another option when constructing vicinities.
Called also taxicab distance, this metric is defined as the sum of the lengths of the projections of the line segment between the points onto the coordinate axes.
\begin{displaymath}
d_1(p,q) = ||p-q||_1 = \sum_{i=1}^n |p_i - q_i|
\end{displaymath}



\input{tikz/vonNeumann}

\section{Scale free network vicinities}
\label{sec:scale free}

\section{Small world network vicinities}
\label{sec:small world}

\section{Custom vicinity structure}
\label{sec:custom vicinity}